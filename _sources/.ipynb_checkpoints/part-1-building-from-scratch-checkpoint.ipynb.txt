{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Building a Recommendation System with the MovieLens dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "import sklearn\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "\n",
    "import warnings\n",
    "warnings.simplefilter(action='ignore', category=FutureWarning)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Import Dataset\n",
    "\n",
    "Let's download a small version of the [MovieLens](https://www.wikiwand.com/en/MovieLens) dataset. See [here](https://grouplens.org/datasets/movielens/) for zip file url, or directly download [here](http://files.grouplens.org/datasets/movielens/ml-latest-small.zip). We're working with data in `ml-latest-small.zip` and will need to add the following files to our repository: \n",
    "- ratings.csv\n",
    "- movies.csv\n",
    "\n",
    "We can use pandas' `read_csv` method which reads csv files into a pandas dataframe. For the code below to work, move the appropriate csv files into a directory called `data/`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>userId</th>\n",
       "      <th>movieId</th>\n",
       "      <th>rating</th>\n",
       "      <th>timestamp</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>31</td>\n",
       "      <td>2.5</td>\n",
       "      <td>1260759144</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>1029</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1260759179</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>1061</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1260759182</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>1129</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1260759185</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>1172</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1260759205</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   userId  movieId  rating   timestamp\n",
       "0       1       31     2.5  1260759144\n",
       "1       1     1029     3.0  1260759179\n",
       "2       1     1061     3.0  1260759182\n",
       "3       1     1129     2.0  1260759185\n",
       "4       1     1172     4.0  1260759205"
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ratings = pd.read_csv(\"data/ratings.csv\")\n",
    "ratings.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>movieId</th>\n",
       "      <th>title</th>\n",
       "      <th>genres</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>Toy Story (1995)</td>\n",
       "      <td>Adventure|Animation|Children|Comedy|Fantasy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Jumanji (1995)</td>\n",
       "      <td>Adventure|Children|Fantasy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Grumpier Old Men (1995)</td>\n",
       "      <td>Comedy|Romance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Waiting to Exhale (1995)</td>\n",
       "      <td>Comedy|Drama|Romance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Father of the Bride Part II (1995)</td>\n",
       "      <td>Comedy</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   movieId                               title  \\\n",
       "0        1                    Toy Story (1995)   \n",
       "1        2                      Jumanji (1995)   \n",
       "2        3             Grumpier Old Men (1995)   \n",
       "3        4            Waiting to Exhale (1995)   \n",
       "4        5  Father of the Bride Part II (1995)   \n",
       "\n",
       "                                        genres  \n",
       "0  Adventure|Animation|Children|Comedy|Fantasy  \n",
       "1                   Adventure|Children|Fantasy  \n",
       "2                               Comedy|Romance  \n",
       "3                         Comedy|Drama|Romance  \n",
       "4                                       Comedy  "
      ]
     },
     "execution_count": 48,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "movies = pd.read_csv(\"data/movies.csv\")\n",
    "movies.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Exploratory Data Analysis"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Number of ratings: 100004\n",
      "Number of unique movieId's: 9066\n",
      "Number of unique users: 671\n",
      "Average number of ratings per user: 149.04\n",
      "Average number of ratings per movie: 11.03\n"
     ]
    }
   ],
   "source": [
    "n_ratings = len(ratings)\n",
    "n_movies = ratings['movieId'].nunique()\n",
    "n_users = ratings['userId'].nunique()\n",
    "\n",
    "\n",
    "print(\"Number of ratings:\", n_ratings)\n",
    "print(\"Number of unique movieId's:\", n_movies)\n",
    "print(\"Number of unique users:\", n_users)\n",
    "print(\"Average number of ratings per user:\", round(n_ratings/n_users, 2))\n",
    "print(\"Average number of ratings per movie:\", round(n_ratings/n_movies, 2))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "metadata": {},
   "outputs": [],
   "source": [
    "user_freq = ratings[['userId', 'movieId']].groupby('userId').count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA04AAAFJCAYAAACsOn0QAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDIuMi4yLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvhp/UCwAAIABJREFUeJzs3XlgVOW9//H3bJnsYIp4ixKKaGTRCJGylKUixQjCBRECRlFElIsSi5VrENkUBBSkCBjUytUWF4iA/qyttxUUqIDQopGlAVsuIip7RDIJmUlmnt8fISMh2wQmhJl8Xn9lznnmnO8zQA7f+T6LxRhjEBERERERkSpZ6zsAERERERGRi50SJxERERERkRoocRIREREREamBEicREREREZEaKHESERERERGpgRInERERERGRGihxknrxzTff0KZNGwYOHMjAgQMZMGAAgwcP5t133/W3ef7558u9rszixYtZs2ZNpefOfP8111xDXl5erWLcvn07U6dOBWDHjh08/PDDtXr/ufB6vYwdO5bU1FRef/31Or9fmYEDB3Ly5Mk6uXZ9fI4iImf65ptvuOaaa3j77bfLHV+6dCkTJ04M2n1uuukmduzYEbTrVcflcjF8+HBuvfVW/vKXv1yQex4+fJjhw4dfkHudad26dTz//PO1ft+YMWNYvXp1HUQkDZW9vgOQhisyMpL/9//+n//1t99+y8iRI4mKiiI1NZVf//rXNV5jy5YtXHXVVZWeC+T91fn3v//N4cOHAbjuuutYuHDheV0vEIcPH+aTTz4hJycHm81W5/crc+afQ7DVx+coInI2q9XKM888Q8eOHWnZsmV9h3PecnNzOX78OB9++OEFu+dll13G8uXLL9j9yuzYsYMffvjhgt9X5GxKnOSicfnll/Pwww+zdOlSUlNTmThxIldffTX33XcfCxcu5MMPP8ThcHDJJZcwe/ZsPvzwQ3bu3Mmzzz6LzWZj7dq1nDhxggMHDnDjjTdy/Phx//sBFixYwI4dO/D5fIwfP55evXqxevVq/vKXv/DSSy8B+F9Pnz6dhQsXkp+fz+OPP86gQYOYMWMG77//Pvn5+Tz55JPs3r0bi8VCjx49+M1vfoPdbue6667jgQceYOPGjRw5coS7776bkSNHVujrP/7xD5599llOnTqFw+Fg/PjxpKSkMHr0aEpKShg8eDCLFi0iMTHR/56JEyfidDrZsWMHx44do2/fviQkJPDxxx9z9OhRZs6cSdeuXauMb9WqVXz00Uf+vu7du5eRI0eybt062rZty+bNm0lISODtt9/mrbfewufz0bhxY6ZMmUKrVq3Kxb9lyxaefvppoqOjKSwsZOXKlTz77LN88cUXFBQUYIxh5syZNGvWrMrPceLEicTGxrJnzx4OHTrElVdeyfz584mJiWH9+vXMmzcPq9VKmzZt2LRpE2+++SZOp5PMzEy+//57AH75y18yfvz4uvjrKCJhJjIyknvvvZdHH32U5cuXExERUe78mc+cs1/fdNNN9O/fn3Xr1nHixAkyMjL47LPP2LVrF3a7nSVLlnDZZZcB8Oabb7J79248Hg/33nsvQ4YMAeCjjz5iyZIlFBcXExkZSWZmJh06dGDRokXk5ORw5MgRrrnmGubNm1curjVr1rB48WK8Xi+xsbE8/vjjxMbGMmnSJA4fPszAgQNZsWIFkZGR/veMGDGCdu3a8emnn3L8+HHuvvtujh8/ztatWzl16hQLFizgmmuu4dChQ0yfPp1vv/0WYwyDBg1i9OjRzJ8/H5fL5R8tsGHDBhYtWsRvf/tbBgwYwOeffw7AkiVL+Otf/4rP5+Pyyy9n2rRpXHbZZfz1r39lyZIlWCwWbDYbjz32GD//+c/L9Wv16tWsXLmSU6dOERsby0svvcT06dP56quv+OGHH4iJiWHevHnk5+ezfPlyvF4vcXFxPPLII1U+pw4fPszEiRM5cuQIzZo14/jx45X+XZg4cSIWi4W9e/eSl5dHt27dmDx5Mg6Hg7179/L0009z4sQJvF4vI0aMYMiQIZU+9878O3TTTTfx/PPPc91115V73aZNG2bMmMFnn32Gw+HgiiuuYPbs2cTExPDZZ58xb948Tp06hcViISMjw/9/kzM/m2XLltXuL7vUHSNSDw4cOGDat29f4fiXX35prr/+emOMMZmZmeaVV14x3333nUlJSTFut9sYY8zSpUvNhx9+aIwx5q677jIffPCBv/0999zjv1bZ+40xJikpybz00kvGGGP27NljOnXqZI4fP25WrVplHnjgAf97znx95s+ffvqpufXWW40xxjz22GNmxowZxufzGbfbbUaNGuW/dlJSklm2bJkxxpgdO3aYa6+91hQVFZXrY15enunatavJycnx97lTp07m66+/rvJzKevP0KFDjcfjMUeOHDFJSUnmD3/4gzHGmNdee83ce++91caXn59vbrjhBnPkyBFjjDHPPvusmT9/vj/u48ePmy1btpj09HRTWFhojDHmb3/7m+nbt2+FWD799FPTunVr88033xhjjPnss89MRkaG8Xq9xhhjXnrpJTNmzJhqP8fMzEwzbNgw43a7jcfjMYMGDTIrV640eXl5plOnTiY3N9cYY8zq1atNUlKSOXDggFm8eLGZMmWKMcaYgoICM378eHPy5MlKPy8RkTJlv1u9Xq9JT083c+bMMcYY88orr5jMzExjTPlnxtmve/XqZWbNmmWMMeZPf/qTad26tf931IMPPmiWLFnibzdt2jRjjDGHDh0yXbp0MV9++aXZt2+f6d+/v8nLyzPGlP7e79atmykoKDALFy40qamppri4uELc//73v80vfvEL8/XXXxtjjNm0aZPp1q2byc/PL/f79Gx33XWXGTdunDHGmJycHJOUlGTWrl1rjDHm6aefNpMnTzbGGHPnnXea//mf/zHGGHPy5EkzYMAA8/7775uvv/7adO7c2f/c/fWvf22ys7PLPaPeeecdM378eH/cy5cvN6NHjzbGGNO7d2/z+eefG2NKnyOLFi2qEOOqVavMz3/+c5Ofn2+MMeaDDz4wM2bM8J+fMmWKeeqpp4wxxixcuNA8+eSTxhhT7XPqwQcfNL/97W+NMcZ89dVXpn379mbVqlUV7p2ZmWkGDRpkXC6Xcbvd5s477zTLli0zxcXFpl+/fmbnzp3+z6Rv377m888/r/DcO1uvXr3M9u3bK7z++9//bm655Rbj8/mMMaXP3m3btpkTJ06Ym2++2Rw4cMAYU/r3pWfPnubbb7+t8NnIxUMVJ7moWCyWct+aQenQgNatW3PbbbfRs2dPevbsSdeuXSt9/w033FDlte+44w4AkpKSaNWqlf8bs9rasGEDb731FhaLhYiICIYPH87vf/97HnjgAQB69+4NQLt27fB4PBQWFuJ0Ov3v3759O4mJiVx//fUAXH311aSkpLB161Y6d+5c7b179eqFw+Hg0ksvJTo6mh49egCQmJjIiRMnaowvNTWV9957j5EjR/Lee+/x5ptvlrv+unXr2L9/f7kx7D/88AMnTpygcePG5dr+9Kc/5fLLLwegQ4cONGrUiOXLl3PgwAG2bNlCTExMjZ9ljx49/N/YJSUl8cMPP/CPf/yDVq1a0bp1awBuu+02Zs6c6W//wAMPcPDgQX7xi1/w6KOPEhcXV+N9RESgdLje3Llzue222+jevXut3nvzzTcD0Lx5c5o0aeL/HZWYmFhuGFnZ78/LLruM7t27s3nzZmw2G0eOHCk3AsFisfD1118D0L59e+z2iv8l+/TTT+nSpQvNmzcHoGvXriQkJLBz504sFku18fbp08cfL1DuebF161YKCwv57LPP+J//+R8A4uLiGDx4MBs2bODWW2+ldevWfPTRR3Tt2pXNmzfz9NNP+6v9AB9//DE7duzg9ttvB8Dn83Hq1CkAbr31VsaNG8cvf/lLunXrxv33319pjNdccw2xsbEA3HLLLTRv3pxly5axf/9+tm7dSocOHSq8p7rn1KZNm8jMzASgRYsW1T5Tb7vtNv9zauDAgaxdu5YuXbrw9ddfM2nSJH+7oqIi/vnPf9KqVatyz71AJSUlYbPZGDp0KN27dyc1NZXk5GTWr1/P0aNHeeihh/xtLRYLe/bsqfDZyMVDiZNcVHbs2EFSUlK5Y1arlddff50dO3awefNmZs2aRefOnZk8eXKF90dHR1d5bav1x7VQjDHY7XYsFgvGGP/x4uLiGmP0+XwVXpeUlPhflyVJZQ+1M69f2fvL2px5jaqcPbSksgdtdfENHTrUP6Thqquu8j9Qz2w7cOBA/vu//9v/+siRIzRq1KjCfc78rNetW8fTTz/NvffeS+/evbnyyit57733auzPmUly2Z+FzWar8JmV/dklJyezdu1aNm/ezKeffsrQoUN54YUXSElJqfFeIiIAzZo1Y/r06WRmZjJo0CD/8ZqeB2f+/nU4HFVev7JnjdfrpWvXrixYsMB/7uDBgzRt2pQPP/ywymfX2b8Ly46VlJRUG8PZ8VYWs8/nq/T5dObz4t133+X48eP06dOHmJiYcomTz+dj9OjRpKenA+DxePwJ5COPPMKQIUP45JNPWL16NS+//DKrV68u99lA+efIm2++SXZ2NnfeeScDBgygcePGfPPNNxX6Vd1z6uw/w8qekWXOnEdsjMFqteL1eomPjy837/fYsWPExcWRk5NT7f8xyq5TxuPxAPiv99lnn/Hpp58yfvx47r77bhITE2nVqlW5BUsOHz5MQkICf/zjH2u8l9QPraonF419+/aRlZXFqFGjyh3fvXs3/fv3p1WrVowZM4aRI0f6v5Gx2WwBJRwA77zzDgC7du1i//79XH/99SQkJPCvf/0Lt9tNSUkJH3/8sb99Vdfu3r07b7zxBsYYPB4P2dnZ/OIXvwi4n9dffz379u1j+/btAPzrX//i73//O506dQr4GtWpLr727dsD8MILLzB06NAK7+3WrRt/+tOfOHLkCABvvfUW99xzT4333LhxI7169SI9PZ3rrruONWvW4PV6gdr9GQGkpKTw1VdfsXv3bgD+8pe/cPLkSSwWC/PmzSMrK4tf/epXPPHEE1x11VV89dVXAV9bRASgb9++9OzZk9///vf+Y5dccgk7d+4EIC8vj3/84x/ndO2yZ813333Hpk2b6Nq1K126dGHjxo3s3bsXgPXr1/Of//mfuN3uaq9V9r4DBw4AsHnzZg4ePOgfsXA+YmNjuf7663njjTcAyM/P59133/U/L/r06cOuXbvIzs4mLS2twvu7d+/OypUrcblcQOlKto899hglJSXcdNNNFBYWcscddzBt2jT27t1b43Pgk08+4bbbbmPo0KG0bNmSjz76qNLnSHXPqR49erBixQqg9PPfsmVLlff74IMP8Hg8uN1u3nnnHXr16kXLli1xOp3+xOngwYP079/f//eiOmWVQICcnByOHj0KlFbmRo4cSYcOHcjIyGDQoEHs3r2b9u3bs3//fv7+978DpYt9pKam+vslFydVnKTeFBUVMXDgQKD0Gzqn08lvfvMbbrzxxnLtWrduTd++fbn99tuJjo4mMjLSX23q1asXzzzzTECVogMHDjBo0CAsFgvz58+ncePGdOvWjZ///Of07duXSy+9lM6dO/uTsg4dOrBgwQIeeugh7r77bv91Jk+ezMyZMxkwYADFxcX06NGD//qv/wq43wkJCTz//PPMmDGDoqIiLBYLs2fPpmXLlpV+u1ZbNcU3dOhQf/Jxth49enD//fczatQoLBYLsbGxLF68uMYhIcOHD2fChAkMGDAAm81Gx44d/ROGq/ocq9K4cWPmz59PZmYmVquVa6+9FrvdTlRUFPfccw8TJ06kf//+REREcM0119C/f//af0gi0uBNnjyZbdu2+V+PGDGCCRMmkJqayhVXXHHOX2a53W5uu+02iouLmTx5sn8Fv6eeeorf/OY3/irUkiVLaqwqXHXVVUybNo1x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\n",
      "text/plain": [
       "<Figure size 1008x360 with 2 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.set_style(\"whitegrid\")\n",
    "plt.figure(figsize=(14,5))\n",
    "plt.subplot(1,2,1)\n",
    "ax = sns.countplot(x=\"rating\", data=ratings, palette=\"viridis\")\n",
    "plt.title(\"Distribution of movie ratings\")\n",
    "\n",
    "plt.subplot(1,2,2)\n",
    "ax = sns.kdeplot(user_freq['movieId'], shade=True, legend=False)\n",
    "plt.axvline(user_freq['movieId'].mean(), color=\"k\", linestyle=\"--\")\n",
    "plt.xlabel(\"# ratings per user\")\n",
    "plt.ylabel(\"density\")\n",
    "plt.title(\"Number of movies rated per user\")\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Which movie has the lowest and highest average rating?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>movieId</th>\n",
       "      <th>title</th>\n",
       "      <th>genres</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1062</th>\n",
       "      <td>1311</td>\n",
       "      <td>Santa with Muscles (1996)</td>\n",
       "      <td>Comedy</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      movieId                      title  genres\n",
       "1062     1311  Santa with Muscles (1996)  Comedy"
      ]
     },
     "execution_count": 52,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mean_rating = ratings.groupby('movieId')[['rating']].mean()\n",
    "\n",
    "lowest_rated = mean_rating['rating'].idxmin()\n",
    "movies.loc[movies['movieId'] == lowest_rated]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>movieId</th>\n",
       "      <th>title</th>\n",
       "      <th>genres</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>50</th>\n",
       "      <td>53</td>\n",
       "      <td>Lamerica (1994)</td>\n",
       "      <td>Adventure|Drama</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    movieId            title           genres\n",
       "50       53  Lamerica (1994)  Adventure|Drama"
      ]
     },
     "execution_count": 53,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "highest_rated = mean_rating['rating'].idxmax()\n",
    "movies.loc[movies['movieId'] == highest_rated]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### A Glimpse at Movie Genres"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>movieId</th>\n",
       "      <th>title</th>\n",
       "      <th>genres</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>Toy Story (1995)</td>\n",
       "      <td>[Adventure, Animation, Children, Comedy, Fantasy]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Jumanji (1995)</td>\n",
       "      <td>[Adventure, Children, Fantasy]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Grumpier Old Men (1995)</td>\n",
       "      <td>[Comedy, Romance]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Waiting to Exhale (1995)</td>\n",
       "      <td>[Comedy, Drama, Romance]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Father of the Bride Part II (1995)</td>\n",
       "      <td>[Comedy]</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   movieId                               title  \\\n",
       "0        1                    Toy Story (1995)   \n",
       "1        2                      Jumanji (1995)   \n",
       "2        3             Grumpier Old Men (1995)   \n",
       "3        4            Waiting to Exhale (1995)   \n",
       "4        5  Father of the Bride Part II (1995)   \n",
       "\n",
       "                                              genres  \n",
       "0  [Adventure, Animation, Children, Comedy, Fantasy]  \n",
       "1                     [Adventure, Children, Fantasy]  \n",
       "2                                  [Comedy, Romance]  \n",
       "3                           [Comedy, Drama, Romance]  \n",
       "4                                           [Comedy]  "
      ]
     },
     "execution_count": 54,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "movies[\"genres\"] = movies[\"genres\"].apply(lambda x: x.split(\"|\"))\n",
    "movies.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### How many genres are there?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "There are 20 genres.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "Counter({'Adventure': 1117,\n",
       "         'Animation': 447,\n",
       "         'Children': 583,\n",
       "         'Comedy': 3315,\n",
       "         'Fantasy': 654,\n",
       "         'Romance': 1545,\n",
       "         'Drama': 4365,\n",
       "         'Action': 1545,\n",
       "         'Crime': 1100,\n",
       "         'Thriller': 1729,\n",
       "         'Horror': 877,\n",
       "         'Mystery': 543,\n",
       "         'Sci-Fi': 792,\n",
       "         'Documentary': 495,\n",
       "         'IMAX': 153,\n",
       "         'War': 367,\n",
       "         'Musical': 394,\n",
       "         'Western': 168,\n",
       "         'Film-Noir': 133,\n",
       "         '(no genres listed)': 18})"
      ]
     },
     "execution_count": 55,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from collections import Counter\n",
    "\n",
    "genre_frequency = Counter(g for genres in movies['genres'] for g in genres)\n",
    "\n",
    "print(\"There are {:d} genres.\".format(len(genre_frequency)))\n",
    "\n",
    "genre_frequency"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The 5 most common genres: \n",
      " [('Drama', 4365), ('Comedy', 3315), ('Thriller', 1729), ('Romance', 1545), ('Action', 1545)]\n"
     ]
    }
   ],
   "source": [
    "print(\"The 5 most common genres: \\n\", genre_frequency.most_common(5))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's also clean up the \"title\" column by remove the year."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Toy Story (1995)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "'Toy Story'"
      ]
     },
     "execution_count": 57,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "title = movies['title'][0]\n",
    "\n",
    "print(title)\n",
    "def get_title(title):\n",
    "    t = title.split(' ')\n",
    "    t.pop()\n",
    "    t = ' '.join(t)\n",
    "    return t\n",
    "\n",
    "get_title(title)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'1995'"
      ]
     },
     "execution_count": 58,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "def get_year(title):\n",
    "    t = title.split(' ')\n",
    "    year = t.pop()\n",
    "    year = year.strip('()')\n",
    "    return year\n",
    "\n",
    "get_year(title)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "metadata": {},
   "outputs": [],
   "source": [
    "movies['year'] = movies['title'].apply(get_year)\n",
    "movies['title'] = movies['title'].apply(get_title) # re-writing title column"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Transforming the data\n",
    "\n",
    "We are going to use a technique called [colaborative filtering]() to generate recommendations for users. This technique is based on the concept of \"homophily\" - similar users will like similar things. Collaborative filtering is a type of unsupervised learning that extracts meaning items for a given user based on what other similar users have liked. \n",
    "\n",
    "The first step is to transform our data into a user-item matrix - also known as a \"utility\" matrix. In this matrix, rows represent users and columns represent items. The beauty of collaborative filtering is that it doesn't require any user or item features to generate recommendations.\n",
    "\n",
    "<img src=\"images/user-movie-matrix.png\" width=\"500px\" align=\"left\">"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The `create_X()` function outputs a sparse matrix X with four mapper dictionaries:\n",
    "- **user_mapper:** maps user id to user index\n",
    "- **movie_mapper:** maps movie id to movie index\n",
    "- **user_inv_mapper:** maps user index to user id\n",
    "- **movie_inv_mapper:** maps movie index to movie id\n",
    "\n",
    "We need these dictionaries because they map which row/column of the utility matrix corresponds to which user/item ID."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "metadata": {},
   "outputs": [],
   "source": [
    "from scipy.sparse import csr_matrix\n",
    "\n",
    "def create_X(df):\n",
    "    \"\"\"\n",
    "    Generates a sparse matrix from ratings dataframe.\n",
    "    \n",
    "    Args:\n",
    "        df: pandas dataframe\n",
    "    \n",
    "    Returns:\n",
    "        X: sparse matrix\n",
    "        user_mapper: dict that maps user id's to user indices\n",
    "        user_inv_mapper: dict that maps user indices to user id's\n",
    "        movie_mapper: dict that maps movie id's to movie indices\n",
    "        movie_inv_mapper: dict that maps movie indices to movie id's\n",
    "    \"\"\"\n",
    "    N = df['userId'].nunique()\n",
    "    M = df['movieId'].nunique()\n",
    "\n",
    "    user_mapper = dict(zip(np.unique(df[\"userId\"]), list(range(N))))\n",
    "    movie_mapper = dict(zip(np.unique(df[\"movieId\"]), list(range(M))))\n",
    "    \n",
    "    user_inv_mapper = dict(zip(list(range(N)), np.unique(df[\"userId\"])))\n",
    "    movie_inv_mapper = dict(zip(list(range(M)), np.unique(df[\"movieId\"])))\n",
    "    \n",
    "    user_index = [user_mapper[i] for i in df['userId']]\n",
    "    item_index = [movie_mapper[i] for i in df['movieId']]\n",
    "\n",
    "    X = csr_matrix((df[\"rating\"], (item_index, user_index)), shape=(M, N))\n",
    "    \n",
    "    return X, user_mapper, movie_mapper, user_inv_mapper, movie_inv_mapper"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "metadata": {},
   "outputs": [],
   "source": [
    "X, user_mapper, movie_mapper, user_inv_mapper, movie_inv_mapper = create_X(ratings)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's check out the sparsity of our X matrix.\n",
    "\n",
    "Here, we calculate sparsity by dividing the number of non-zero elements by total number of elements as described in the equation below: \n",
    "\n",
    "$$S=\\frac{\\text{# non-zero elements}}{\\text{total elements}}$$"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Matrix sparsity: 1.64%\n"
     ]
    }
   ],
   "source": [
    "sparsity = X.count_nonzero()/(X.shape[0]*X.shape[1])\n",
    "\n",
    "print(\"Matrix sparsity: {0:.2f}%\".format(sparsity*100))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<img src=\"images/knn.png\" width=\"20%\" align=\"right\"/>\n",
    "## Finding similar movies using k-Nearest Neighbours\n",
    "\n",
    "This approach looks for the \"k\" nearest neighbours of a given movie using different distance metrics like cosine similarity, euclidean distance, etc. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.neighbors import NearestNeighbors\n",
    "\n",
    "def find_similar_movies(movie_id, X, k, metric='cosine'):\n",
    "    \"\"\"\n",
    "    Finds k-nearest neighbours for a given movie id.\n",
    "    \n",
    "    Args:\n",
    "        movie_id: id of the movie of interest\n",
    "        X: user-item utility matrix\n",
    "        k: number of similar movies to retrieve\n",
    "        metric: distance metric for kNN calculations\n",
    "    \n",
    "    Output: returns list of k similar movie ID's\n",
    "    \"\"\"\n",
    "    neighbour_ids = []\n",
    "    \n",
    "    movie_ind = movie_mapper[movie_id]\n",
    "    movie_vec = X[movie_ind]\n",
    "    k+=1\n",
    "    kNN = NearestNeighbors(n_neighbors=k, algorithm=\"brute\", metric=metric)\n",
    "    kNN.fit(X)\n",
    "    if isinstance(movie_vec, (np.ndarray)):\n",
    "        movie_vec = movie_vec.reshape(1,-1)\n",
    "    neighbour = kNN.kneighbors(movie_vec, return_distance=False)\n",
    "    for i in range(0,k):\n",
    "        n = neighbour.item(i)\n",
    "        neighbour_ids.append(movie_inv_mapper[n])\n",
    "    neighbour_ids.pop(0)\n",
    "    return neighbour_ids"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Because you watched  Toy Story\n",
      "Toy Story 2\n",
      "Star Wars: Episode IV - A New Hope\n",
      "Forrest Gump\n",
      "Independence Day (a.k.a. ID4)\n",
      "Groundhog Day\n",
      "Back to the Future\n",
      "Jurassic Park\n",
      "Shrek\n",
      "Star Wars: Episode VI - Return of the Jedi\n",
      "Pulp Fiction\n"
     ]
    }
   ],
   "source": [
    "movie_titles = dict(zip(movies['movieId'], movies['title']))\n",
    "\n",
    "movie_id = 1\n",
    "\n",
    "similar_ids = find_similar_movies(movie_id, X, k=10)\n",
    "\n",
    "print(\"Because you watched \", movie_titles[movie_id])\n",
    "for i in similar_ids:\n",
    "    print(movie_titles[i])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "You can also play around with the kNN distance metric and see what results you would get if you use \"manhattan\" or \"euclidean\" instead of \"cosine\"."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Because you watched  Toy Story\n",
      "Toy Story 2\n",
      "Star Wars: Episode IV - A New Hope\n",
      "Forrest Gump\n",
      "Independence Day (a.k.a. ID4)\n",
      "Groundhog Day\n",
      "Back to the Future\n",
      "Jurassic Park\n",
      "Shrek\n",
      "Star Wars: Episode VI - Return of the Jedi\n",
      "Pulp Fiction\n"
     ]
    }
   ],
   "source": [
    "movie_titles = dict(zip(movies['movieId'], movies['title']))\n",
    "\n",
    "movie_id = 1\n",
    "\n",
    "similar_ids = find_similar_movies(movie_id, X, k=10, metric=\"cosine\")\n",
    "\n",
    "print(\"Because you watched \", movie_titles[movie_id])\n",
    "for i in similar_ids:\n",
    "    print(movie_titles[i])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### What if a new movie hasn't been rated yet?\n",
    "\n",
    "Collaborative filtering relies solely on user-item interactions within the utility matrix. The issue with this approach is that brand new users or items with no iteractions get excluded from the recommendation system. This is called the \"cold start\" problem. Content-based filtering is a way to handle this problem by generating recommendations based on user and item features.\n",
    "\n",
    "First, we need to convert the \"genres\" column into binary features. Each genre will have its own column in the dataframe, and will be populated with 0 or 1. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "metadata": {},
   "outputs": [],
   "source": [
    "genres = set(g for G in movies['genres'] for g in G)\n",
    "\n",
    "for g in genres:\n",
    "    movies[g] = movies.genres.transform(lambda x: int(g in x))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "metadata": {},
   "outputs": [],
   "source": [
    "movie_genres = movies.drop(columns=['movieId', 'title','year', 'genres'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 84,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Dimensions of our genres cosine similarity matrix:  (9125, 9125)\n"
     ]
    }
   ],
   "source": [
    "from sklearn.metrics.pairwise import cosine_similarity\n",
    "\n",
    "# create mapper that maps index to title and vice versa\n",
    "movie_indices = dict(zip(movies['title'], list(movies.index)))\n",
    "cosine_sim = cosine_similarity(movie_genres, movie_genres)\n",
    "\n",
    "print(\"Dimensions of our genres cosine similarity matrix: \",cosine_sim.shape)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 102,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Recommendations for Toy Story: \n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "1815                                                Antz\n",
       "2506                                         Toy Story 2\n",
       "3003             Adventures of Rocky and Bullwinkle, The\n",
       "3217                           Emperor's New Groove, The\n",
       "3805                                      Monsters, Inc.\n",
       "6705                                     Shrek the Third\n",
       "7146                             Tale of Despereaux, The\n",
       "7945    Asterix and the Vikings (Astérix et les Vikings)\n",
       "8366                                               Turbo\n",
       "8676                                      Boxtrolls, The\n",
       "Name: title, dtype: object"
      ]
     },
     "execution_count": 102,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "title = movies['title'][0]\n",
    "n_recommendations = 10\n",
    "\n",
    "idx = movie_indices[title]\n",
    "sim_scores = list(enumerate(cosine_sim[idx]))\n",
    "sim_scores = sorted(sim_scores, key=lambda x: x[1], reverse=True)\n",
    "sim_scores = sim_scores[1:(n_recommendations+1)]\n",
    "similar_movies = [i[0] for i in sim_scores]\n",
    "print(\"Recommendations for {:s}: \".format(title))\n",
    "movies['title'].iloc[similar_movies]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Advanced: matrix factorization\n",
    "\n",
    "Matrix factorization is a technique that helps \"latent\" features by reducing dimensionality.\n",
    "\n",
    "Let's reduce the dimensions of our utility matrix using Single Vector Decomposition (SVD) and see how our results turns out."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Because you watched  Toy Story\n",
      "Toy Story 2\n",
      "Independence Day (a.k.a. ID4)\n",
      "Star Wars: Episode IV - A New Hope\n",
      "Forrest Gump\n",
      "Groundhog Day\n",
      "Shrek\n",
      "Bug's Life, A\n",
      "Jurassic Park\n",
      "Back to the Future\n",
      "Star Wars: Episode VI - Return of the Jedi\n"
     ]
    }
   ],
   "source": [
    "from sklearn.decomposition import TruncatedSVD\n",
    "\n",
    "svd = TruncatedSVD(n_components=200, n_iter=10, random_state=42)\n",
    "Z = svd.fit_transform(X)\n",
    "similar_ids = find_similar_movies(movie_id, Z, k=10)\n",
    "\n",
    "print(\"Because you watched \", movie_titles[movie_id])\n",
    "for i in similar_ids:\n",
    "    print(movie_titles[i])"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
