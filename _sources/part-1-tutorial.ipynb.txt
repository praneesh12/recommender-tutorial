{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Part 1: Building a Recommendation System for Explicit Feedback Datasets\n",
    "\n",
    "We will be using a [MovieLens](https://movielens.org/) dataset to build a simple recommendation system in Python. MovieLens is a platform where users rate movies, and get personalized recommendations based on their preferences. It has several publicly available datasets that are widely used for recommendation system tutorials.\n",
    "\n",
    "MovieLens is an **explicit feedback** dataset. Ratings represent a user's direct feedback towards a movie. An example of implicit feedback would be duration of time a user has spent watching a movie."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Dependencies"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "import sklearn\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "\n",
    "import os\n",
    "import warnings\n",
    "warnings.simplefilter(action='ignore', category=FutureWarning)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Import Dataset"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's download a small version of the MovieLens dataset. See [here](https://grouplens.org/datasets/movielens/) for zip file url. We're working with data in `ml-latest-small.zip` and will need to add the following files to our repository: \n",
    "- ratings.csv\n",
    "- movies.csv\n",
    "\n",
    "We can use pandas' `read_csv` method which reads csv files into a pandas dataframe. For the code below to work, move the appropriate csv files into a directory called `data/`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>userId</th>\n",
       "      <th>movieId</th>\n",
       "      <th>rating</th>\n",
       "      <th>timestamp</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>31</td>\n",
       "      <td>2.5</td>\n",
       "      <td>1260759144</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>1029</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1260759179</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>1061</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1260759182</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>1129</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1260759185</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>1172</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1260759205</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   userId  movieId  rating   timestamp\n",
       "0       1       31     2.5  1260759144\n",
       "1       1     1029     3.0  1260759179\n",
       "2       1     1061     3.0  1260759182\n",
       "3       1     1129     2.0  1260759185\n",
       "4       1     1172     4.0  1260759205"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ratings = pd.read_csv(os.path.join(\"data\", \"ratings.csv\"))\n",
    "ratings.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Exploratory Data Analysis"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's take a look at the data and perform some basic exploratory data analysis."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Number of ratings: 100004\n",
      "Number of unique movieId's: 9066\n",
      "Number of unique users: 671\n",
      "Average number of ratings per user: 149.04\n",
      "Average number of ratings per movie: 11.03\n"
     ]
    }
   ],
   "source": [
    "n_ratings = len(ratings)\n",
    "n_movies = ratings['movieId'].nunique()\n",
    "n_users = ratings['userId'].nunique()\n",
    "\n",
    "print(\"Number of ratings:\", n_ratings)\n",
    "print(\"Number of unique movieId's:\", n_movies)\n",
    "print(\"Number of unique users:\", n_users)\n",
    "print(\"Average number of ratings per user:\", round(n_ratings/n_users, 2))\n",
    "print(\"Average number of ratings per movie:\", round(n_ratings/n_movies, 2))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "ax = sns.countplot(x=\"rating\", data=ratings, palette=\"GnBu\")\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "user_freq = ratings[['userId', 'movieId']].groupby('userId').count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Text(0.5,1,'Number of movies rated per user')"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "ax = sns.kdeplot(user_freq['movieId'], shade=True)\n",
    "\n",
    "# add vertical line to represent mean\n",
    "plt.axvline(user_freq['movieId'].mean(), color=\"k\", linestyle=\"--\")\n",
    "\n",
    "# add x/y labels and title\n",
    "ax.set(xlabel='# ratings per user', ylabel='density')\n",
    "plt.title(\"Number of movies rated per user\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Transforming the data"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We need to transform our dataframe into a sparse matrix such that rows represents users and columns represent items. This is called a **utility matrix** and forms the basis of collaborative filtering. Remember: collaborative filtering is a technique that identifies similar users and recommends what similar users like. It doesn't require any user or item features! \n",
    "\n",
    "<img src=\"images/user-movie-matrix.png\" width=\"500px\" align=\"left\">"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The `create_X()` function outputs a sparse matrix X with four mapper dictionaries:\n",
    "- **user_mapper:** maps user id to user index\n",
    "- **movie_mapper:** maps movie id to movie index\n",
    "- **user_inv_mapper:** maps user index to user id\n",
    "- **movie_inv_mapper:** maps movie index to movie id"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split\n",
    "\n",
    "train_ratings, valid_ratings = train_test_split(ratings, test_size=0.2, random_state=42)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "from scipy.sparse import csr_matrix\n",
    "\n",
    "def create_X(df):\n",
    "    \"\"\"\n",
    "    Generates a sparse matrix from ratings dataframe.\n",
    "    \n",
    "    Args:\n",
    "        df: pandas dataframe\n",
    "    \n",
    "    Returns:\n",
    "        X: sparse matrix\n",
    "        user_mapper: dict that maps user id's to user indices\n",
    "        user_inv_mapper: dict that maps user indices to user id's\n",
    "        movie_mapper: dict that maps movie id's to movie indices\n",
    "        movie_inv_mapper: dict that maps movie indices to movie id's\n",
    "    \"\"\"\n",
    "    N = df['userId'].nunique()\n",
    "    M = df['movieId'].nunique()\n",
    "\n",
    "    user_mapper = dict(zip(np.unique(df[\"userId\"]), list(range(N))))\n",
    "    movie_mapper = dict(zip(np.unique(df[\"movieId\"]), list(range(M))))\n",
    "    \n",
    "    user_inv_mapper = dict(zip(list(range(N)), np.unique(df[\"userId\"])))\n",
    "    movie_inv_mapper = dict(zip(list(range(M)), np.unique(df[\"movieId\"])))\n",
    "    \n",
    "    user_index = [user_mapper[i] for i in df['userId']]\n",
    "    item_index = [movie_mapper[i] for i in df['movieId']]\n",
    "\n",
    "    X = csr_matrix((df[\"rating\"], (user_index, item_index)), shape=(N, M))\n",
    "    \n",
    "    return X, user_mapper, movie_mapper, user_inv_mapper, movie_inv_mapper"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 94,
   "metadata": {},
   "outputs": [],
   "source": [
    "X, user_mapper, movie_mapper, user_inv_mapper, movie_inv_mapper = create_X(ratings)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
